var PatientCard = React.createClass({
  getDefaultProps: function() {
    return {
      canEdit: false,
      canAddTest: true
    }
  },

  render: function () {
    var patient = this.props.patient;

    if (patient == null) {
      return (
        <%= to_jsx(card(image: asset_url('card-unkown.png')) do |c|
          c.top do
            "No patient information"
          end
        end) %>
      );
    } 
    else 
    {
      return (
      <ul>
        <li>
          <label>{Patient.human_attribute_name(:name)}</label>
          {patient_display_name(patient.name)}
        </li>
        <li>
          <label>{Patient.human_attribute_name(:gender)}</label>
          {patient.gender}
        </li>
        <li>
          <label>{Patient.human_attribute_name(:dob)}</label>
          {patient_birth_date(patient.dob)}
        </li>
        <li>
          <label>{Patient.human_attribute_name(:phone)}</label>
          {patient.phone}
        </li>
        <li>
          <label>{Patient.human_attribute_name(:email)}</label>
          {patient.email}
        </li>
      </ul>
      <ul>
        <li>
          <label>{Patient.human_attribute_name(:entity_id)}</label>
          {patient.entity_id}
        </li>
        <li>
          <label>{ Patient.human_attribute_name(:address)}</label>
          {patient.address}
        </li>
      </ul>
      <ul>
        <li>
          <label>{Patient.human_attribute_name(:created_at)}</label>
          {I18n.l(patient.created_at, format: :long)}
        </li>
      </ul>

      {(function(){
        if (!this.props.canEdit) return;
        return (
          <a href={"/patients/" + patient.id + "/edit"} title="Edit">
            <img src="#{asset_url("ic-pencil.png")}"/>
          </a>);
      }.bind(this))()}
      {(function(){
        if (!this.props.canAddTest) return;
        if (this.props.showTestLink != true) return;
        return (
          <a href={"/encounters/new?mode=fresh_tests&patient_id=" + patient.id } title="Create Test Order" className="label">
            Create Test Order
          </a>);
      }.bind(this))()}
      );
    }
  }
});
