SuperAdmin:
{
  "granter" :  null,
  "delegable": true,
  "effect": "allow", // deny - default:allow
  "action": "*", // not_action
  "resouce": "*"
}

Everyone (implicit):
{
  "action": "*",
  "resource": "*",
  "condition": {"equals" : {"owner" : ["self"]}}
}

Permission to add locations under location with id 7:
{
  "action": "adminLocations",
  "resource": "cdp:location/5/7/*"
}

Create a device in any lab of institution 1:
{
  "action": "createDevices",
  "resource": [
    "cdp:laboratory/*",
    "cdp:institution/1"
  ]
}

Admin for devices under location 7:
{
  "action": "adminDevices",
  "resource": [
    "cdp:institution/1",
    "cdp:laboratory",
    "cdp:location/5/7/*"
  ]
}

Admin for devices under location 7 (option B):
{
  "action": "*",
  "resource": "cdp:device",
  "condition" : [
    {"equals" : {"cdp:institution" : [1]}},
    {"like" : {"cdp:location":["5/7/*"]}}
  ]
}

Institution Admin under location 7:
Statements: [
  {
    "action" : "*", //"adminAll" ?
    "resource" : "cdp:laboratory",
    "condition" : [
      {"equals" : {"cdp:institution" : [1]}},
      {"like" : {"cdp:location":["5/7/*"]}}
    ]
  },
  {
    "action" : "*",
    "resource" : "cdp:device",
    "condition": {"equals" : {"cdp:institution" : [1]}}
  },
  {
    "action" : [
      "updateInstitution",
      "deleteInstitution"
    ],
    "resource" : "cdp:institution",
    "condition": {"equals" : {"cdp:institution" : [1]}}
  }
]

Institution Admin under location 7 (option B):
{
  "action" : [
    "listDevice",
    "retrieveDevice",
    "createDevice",
    "updateDevice",
    "deleteDevice",
    "listLaboratory",
    "retrieveLaboratory",
    "createLaboratory",
    "updateLaboratory",
    "deleteLaboratory",
    "updateInstitution",
    "deleteInstitution"
  ],
  "resource" : "*",
  "condition": [
    {"like" : {"cdp:location":["5/7/*"]}},
    {"equals" : {"cdp:institution" : [1]}}
  ]
}

Institution Admin:
{
  "action" : "*",
  "resource" : [
    "cdp:laboratory",
    "cdp:device",
  ],
  "condition" : {"equals" : {"cdp:institution" : [1]}}
}

Institution Admin (option B):
{
  "action" : [
    "listDevice",
    "retrieveDevice",
    "createDevice",
    "updateDevice",
    "deleteDevice",
    "listLaboratory",
    "retrieveLaboratory",
    "createLaboratory",
    "updateLaboratory",
    "deleteLaboratory",
    "updateInstitution",
    "deleteInstitution"
  ],
  "resource" : "*",
  "condition" : {"equals" : {"cdp:institution" : [1]}}
}

Read Permission for tests grouped yearly by date ranges and location:
{
  "action" : [
    "queryTestResults"
  ],
  "resource" : "cdp:api",
  "condition" : { "group_by" : [
    { "age" : [ [0, 10], [11, 20] ] },
    { "time_interval" : [{ "created_at" : "yearly" }]},
    { "location_depth" : 3 }
  ]}
}
