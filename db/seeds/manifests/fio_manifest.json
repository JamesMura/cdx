{
  "metadata" : {
    "version" : "1.0.4",
    "api_version" : "1.2.1",
    "device_models" : ["FIO"],
    "conditions": ["MTB"],
    "source": {
      "type" : "xml",
      "root" : "DiagnosticTests"
    }
  },
  "custom_fields" : [
    {
      "name" : "patient.name",
      "type" : "string",
      "pii" : true
    },
    {
      "name" : "patient.pregnancy_status",
      "type" : "string"
    }
  ],
  "field_mapping" : {
    "patient.id" : {"lookup" : "Patient/Id/text()"},
    "patient.name" : {"lookup" : "Patient/Name/text()"},
    "test.patient_age" : {"lookup" : "Patient/Age/text()"},
    "patient.gender" : { "lowercase": { "lookup" : "Patient/Gender/text()" } },
    "patient.pregnancy_status" : {"lookup" : "Patient/PregnancyStatus/text()"},
    "sample.uid" : {"lookup" : "SampleId/text()"},
    "sample.id" : {"lookup" : "SampleId/text()"},
    "test.start_time" : {"lookup" : "TestDate/text()"},
    "test.id" : {"lookup" : "@id"},
    "test.name" : {"lookup" : "Test/Code/@value"},
    "test.status" : {
      "case" : [
        { "lookup": "Test/Control/@qualitative" },
        [
          { "when" : "Valid", "then" : "success"},
          { "when" : "*", "then" : "error"}
        ]
      ]
    },
    "test.assays[*].qualitative_result" : { "lowercase" : {"lookup" : "Test/Assay/Result/@qualitative"} },
    "test.assays[*].name" : {"lookup" : "Test/Assay/@code"}
  }
}
